name: A-Share AI Daily Run
on:
  schedule:
    - cron: '0 10 * * 1-5'
  workflow_dispatch:
jobs:
  ai-inference:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Code
        uses: actions/checkout@v3
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'
          cache: 'pip'
      - name: Install System Dependencies
        run: |
          sudo apt-get update
          sudo apt-get install -y cmake bison flex libopenmpi-dev
      - name: Install Python Libraries
        run: |
          pip install --upgrade pip
          pip install akshare pandas scikit-learn psycopg2-binary
          pip install pyqlib || echo "Qlib install failed, using fallback mode"
      - name: Run AI Prediction Script
        env:
          POSTGRES_URL: ${{ secrets.POSTGRES_URL }}
        run: |
          python scripts/run_prediction.py
